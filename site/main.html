<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>RYL Classic</title>
<meta name="keywords" content />
<meta name="description" content />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Philosopher:wght@400;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
<link href="/files/css/style.css" rel="stylesheet">
<link href="/files/css/mobile-style.css" rel="stylesheet">
<script src="https://js.hcaptcha.com/1/api.js" async defer></script>
</head>
<body>
<div class="wrapper
register
">
<header>
  <div class="hand-animation">
    <div class="light-hand"></div>
    <div class="rune-hand"></div>
    </div>
    <div class="sparks">
    <div class="spark_1"></div>
    <div class="spark_2"></div>
    <div class="spark_3"></div>
    <div class="spark_4 spark-big"></div>
    </div>
    <div class="logo">
    <a href class="bright"><img src="/files/images/logo.png" alt="Logo"></a>
    </div>
</header>
<main class="main">
<div class="mainRegister">
<div class="regBlock" style="padding: 100px 120px !important;">
<span class="modalTitle">Create Your Account</span>
<form id="registroForm">
<div class="fields">
<div class="fieldGroup" style="margin: 0 0 10px 0 !important">
<span>Username</span>
<input type="text" id="username" name="username" placeholder="your nickname" required maxlength="12" pattern="[a-zA-Z0-9]+">
<p class="text-muted">
<ul>
<li style="margin: 5px; opacity: 0.5; !important">* This is your forum nickname. Use only letters and numbers</li>
</ul>
</p>
</div>
<div class="fieldGroup" style="margin: 0 0 10px 0 !important">
<span>Email</span>
<input type="email" id="email" placeholder="mail@domain.com" name="email" required>
<p class="text-muted">
<ul>
<li style="margin: 5px; opacity: 0.5; !important;">* Enter a valid email address for confirmation email.</li>
</ul>
</p>
</div>
<div class="fieldGroup" style="margin: 0 0 10px 0 !important">
<span>Password</span>
<input type="password" id="senha" placeholder="******" name="senha" required minlength="6">
<p class="text-muted">
<ul>
<li style="margin: 5px; opacity: 0.5; !important">* Must have at least 6 characters.</li>
</ul>
</p>
</div>
<div class="fieldGroup" style="margin: 0 0 10px 0 !important">
<span>Confirm password</span>
<input type="password" id="confirmarSenha" name="confirmarSenha" placeholder="******" required minlength="6">
<p class="text-muted">
<ul>
<li style="margin: 5px; opacity: 0.5; !important">*Please confirm the password.</li>
</ul>
</p>
</div>
</div>
<div class="fieldGroup" style="margin: 0 0 10px 0 !important">
<!-- Campo hCaptcha -->
<div class="h-captcha" data-sitekey="40f230e9-576b-4ca6-9b00-bf289abdc8b1"></div>
</div>
</br>
<button class="big-button-blue" type="submit">Sign In Now</button>
</form>
</div>
</main>
</div>
<script>

const senhaInput = document.getElementById('senha');
    const confirmarSenhaInput = document.getElementById('confirmarSenha');
    const senhaError = document.getElementById('senhaError');

    document.getElementById('registroForm').addEventListener('submit', async function (event) {
      event.preventDefault();

    // Bloquear cópia/colagem nos campos de senha
    senhaInput.addEventListener('copy', (event) => {
      event.preventDefault();
    });

    senhaInput.addEventListener('paste', (event) => {
      event.preventDefault();
    });

    confirmarSenhaInput.addEventListener('copy', (event) => {
      event.preventDefault();
    });

    confirmarSenhaInput.addEventListener('paste', (event) => {
      event.preventDefault();
    });

      const formData = new FormData(this);

      try {
        // Obter o token do hCaptcha apenas se o formulário não tiver erros
        if (this.checkValidity()) {
          const hcaptchaToken = window.hcaptcha.getResponse();
          formData.append('hcaptchaToken', hcaptchaToken);
        }

        const response = await fetch('http://192.168.94.110:3000/registrar', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(Object.fromEntries(formData)),
        });

        if (response.ok) {
  const successMessage = await response.text(); // Obtém o conteúdo da resposta
  alert(`${successMessage}`);
  location.reload(); // Recarrega a página
} else {
  const errorText = await response.text();
  alert(`Erro ao registrar usuário: ${errorText}`);
}
      } catch (error) {
        console.error('Erro ao enviar solicitação:', error.message);
        alert('Erro interno do cliente.');
        window.hcaptcha.reset(); // Resetar o hCaptcha em caso de erro
      }
    });

  </script>
  
<footer>
<div class="wrapper">
<div class="footerMenu flex">
Aqui colocar social pages
</div>
<span class="line"></span>
<div class="footerInfo">
<div class="footerInfo-block flex-s">
<div class="copy"><span>© 2024</span> - <a href="https://dominio.com">Dominio.com</a> - <span>All rights reserved</span></div>
</div>
<div class="f-text">
SEO Google!
</div>
</div>
</footer>
</html>
